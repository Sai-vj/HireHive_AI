{% extends "frontend/base.html" %}
{% block title %}Home - HireApp{% endblock %}
{% block content %}
<div class="text-center p-5 bg-light rounded shadow-sm">
  <h1 class="fw-bold">Welcome to HireApp üöÄ</h1>
  <p class="lead">Your one-stop platform for Jobs, Interviews and Analytics</p>
  {% if user.is_authenticated %}
    <a href="{% url 'frontend:go_to_dashboard' %}" class="btn btn-primary btn-lg">Go to Dashboard</a>
  {% else %}
    <a href="{% url 'login' %}" class="btn btn-success btn-lg me-2">Login</a>
    <a href="{% url 'register' %}" class="btn btn-outline-primary btn-lg">Register</a>
  {% endif %}
</div>

<div class="row mt-5 g-4">
  <div class="col-md-4">
    <div class="card h-100 shadow-sm p-3">
      <h5>üíº Apply Jobs</h5>
      <p>Browse jobs and track your applications easily.</p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card h-100 shadow-sm p-3">
      <h5>üìù Attend Interviews</h5>
      <p>Quizzes and coding challenges to showcase your skills.</p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card h-100 shadow-sm p-3">
      <h5>üìä Analytics</h5>
      <p>Know your strengths and improve continuously.</p>
    </div>
  </div>
</div>
<!-- Jobs preview (paste into home.html) -->
<div class="mt-5">
  <h4>Latest jobs</h4>
  <div id="homeJobs" class="list-group"></div>
  <div class="mt-2">
    <a href="/jobs/" class="btn btn-outline-primary btn-sm">View all jobs</a>
  </div>
</div>

<script>
(async function(){
  try {
    const wrap = document.getElementById('homeJobs');
    if(!wrap) return;
    wrap.innerHTML = '<div class="small-muted">Loading jobs...</div>';
    const r = await fetch('/api/resumes/jobs/');
    if(!r.ok) { wrap.innerHTML = '<div class="text-muted">Jobs unavailable</div>'; return; }
    const data = await r.json().catch(()=>({}));
    const jobs = Array.isArray(data) ? data : (data.results || []);
    if(!jobs || jobs.length===0) { wrap.innerHTML = '<div class="text-muted">No jobs right now</div>'; return; }
    wrap.innerHTML = '';
    jobs.slice(0,3).forEach(j => {
      const el = document.createElement('a');
      el.className = 'list-group-item list-group-item-action d-flex justify-content-between align-items-start';
      const title = j.title || j.name || `Job ${j.id||''}`;
      const company = j.company || j.employer || '';
      el.href = `/jobs/${encodeURIComponent(j.id || j.pk || '')}/`;
      el.innerHTML = `<div style="min-width:0">
          <strong>${title}</strong><div class="small text-muted">${company}</div>
        </div>
        <div class="small text-muted">View</div>`;
      wrap.appendChild(el);
    });
  } catch (e) {
    console.error('jobs preview err', e);
  }
})();
</script>

{% endblock %}
